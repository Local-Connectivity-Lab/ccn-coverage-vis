(this["webpackJsonpcnn-coverage-vis"]=this["webpackJsonpcnn-coverage-vis"]||[]).push([[0],{104:function(e,t,n){},248:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(23),o=n.n(r),s=(n(104),n(5)),c=n(277),l=n(278),d=n(280),u=n(251),p=n(282),f=n(279),b=n(272),h=n(281),j=(n(59),n(2)),m={dbm:1,ping:1,upload_speed:1,download_speed:1};function g(e){return Object(j.jsx)(f.a,{className:"App",children:Object(j.jsxs)(h.a,{component:"fieldset",disabled:e.loading,children:[Object(j.jsx)(u.a,{variant:"overline",children:"Map Type"}),Object(j.jsxs)(p.a,{"aria-label":"Map Type",name:"maptype",value:e.mapType,onChange:function(t){var n=t.target.value;if(!(n in m))throw new Error("Invalid map type selection: "+n);e.setMapType(n)},children:[Object(j.jsx)(b.a,{value:"dbm",control:Object(j.jsx)(d.a,{}),label:"Signal Strength"}),Object(j.jsx)(b.a,{value:"upload_speed",control:Object(j.jsx)(d.a,{}),label:"Upload Speed"}),Object(j.jsx)(b.a,{value:"download_speed",control:Object(j.jsx)(d.a,{}),label:"Download Speed"}),Object(j.jsx)(b.a,{value:"ping",control:Object(j.jsx)(d.a,{}),label:"Ping"})]})]})})}var v=n(274),y=n(283),x=n(284),O=n(275),S=n(276),w=n(273),M=n(105),k=n.n(M),A=Object(v.a)((function(e){return Object(y.a)({root:{flexGrow:1,marginBottom:"20px"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}})}));function T(){var e=A();return Object(j.jsx)("div",{className:e.root,children:Object(j.jsx)(x.a,{position:"static",children:Object(j.jsxs)(O.a,{children:[Object(j.jsx)(w.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",children:Object(j.jsx)(k.a,{})}),Object(j.jsx)(u.a,{variant:"h6",className:e.title,children:"CCN - Performance Evaluation"}),Object(j.jsx)(S.a,{color:"inherit",children:"About"})]})})})}var L=n(107),C=n(48),_=C.map((function(e){var t=e.name;return{label:t,value:t}})),E=function(e){return Object(j.jsxs)(f.a,{mb:2,children:[Object(j.jsx)(u.a,{variant:"overline",children:"Select Sites"}),Object(j.jsx)(L.a,{options:_,value:e.selectedSites,onChange:e.setSelectedSites,labelledBy:"Select",disabled:e.loading})]})},B=n(10),D=n.n(B),N=n(62),W=n(20),z=n(14),R=n(8);function U(e){return Math.round(100*e)/100}var P=new Map([["active","green"],["confirmed","yellow"],["in-conversation","red"]]);function G(e){return e.every(J)}function J(e){return"string"===typeof(null===e||void 0===e?void 0:e.name)||"number"===typeof(null===e||void 0===e?void 0:e.latitude)||"number"===typeof(null===e||void 0===e?void 0:e.longitude)||"string"===typeof(null===e||void 0===e?void 0:e.address)||(null===e||void 0===e?void 0:e.status)in P}function q(e,t){return z.marker([e.latitude,e.longitude]).bindTooltip("".concat(e.name,' <span style="background-color: ').concat(P.get(e.status),'">[').concat(e.status,"]</span><br />").concat(e.address,"<br/>ping: ").concat(U((null===t||void 0===t?void 0:t.ping)*ne.ping)," ").concat(te.ping,"<br/>upload speed: ").concat(U((null===t||void 0===t?void 0:t.upload_speed)*ne.upload_speed)," ").concat(te.upload_speed,"<br/>download speed: ").concat(U((null===t||void 0===t?void 0:t.download_speed)*ne.download_speed)," ").concat(te.download_speed))}function H(e){var t=e.map,n=e.center,a=e.minLat,i=e.minLon,r=e.maxLat,o=e.maxLon,s=e.width,c=e.height,l=t.project(n),d=l.x,u=l.y,p=t.project([a,i]),f=[Math.floor(Math.min(d-s/2,p.x-s/10)),Math.ceil(Math.max(u+c/2,p.y+c/10))],b=t.project([r,o]),h=[Math.ceil(Math.max(d+s/2,b.x+s/10)),Math.floor(Math.min(u-c/2,b.y-c/10))],j=t.unproject(f),m=t.unproject(h),g=z.latLngBounds(j,m);return t.setMaxBounds(g).on("drag",(function(){return t.panInsideBounds(g,{animate:!1})})),{width:h[0]-f[0],height:f[1]-h[1],left:f[0],top:h[1]}}var F=n(106),I=150,K=40,V=I/64;var Y=function(e){var t=e.colorDomain,n=e.title,i=e.width,r=Object(a.useRef)(null);if(t&&r.current){var o=R.n(t,R.f),s=R.d(".2f"),c=R.q(r.current).attr("width",i).attr("height",I).attr("viewBox",[0,0,i,I].join(" ")).style("overflow","visible").style("display","block");c.selectAll("*").remove();var l=Object.assign(o.copy().interpolator(R.e(K,I-0)),{range:function(){return[I-0,K]}});c.append("image").attr("x",0).attr("y",K).attr("width",i-0-15).attr("height",I-K-0).attr("preserveAspectRatio","none").attr("xlink:href",function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,n=Object(F.createCanvas)(1,t),a=n.getContext("2d"),i=0;i<t;++i)a.fillStyle=e(i/(t-1)),a.fillRect(0,i,1,1);return n}(o.interpolator(),I-K-0).toDataURL());var d=Math.round(V+1),u=R.k(d).map((function(e){var t;return null!==(t=R.j(o.domain(),e/(d-1)))&&void 0!==t?t:NaN}));c.append("g").attr("transform","translate(".concat(0,",",0,")")).call(R.b(l).ticks(V,"string"===typeof s?s:void 0).tickSize(6).tickValues(u)).call((function(e){return e.selectAll(".tick line").attr("x1",i-15-0)})).call((function(e){return e.select(".domain").remove()})).call((function(e){return e.append("text").attr("y",28).attr("x",i-15-0-2).attr("fill","currentColor").attr("text-anchor","begin").attr("font-weight","bold").attr("class","title").text(n)}))}return Object(j.jsx)("svg",{id:"map-legend",ref:r,className:"leaflet-control"})};function Z(e){return X.apply(this,arguments)}function X(){return(X=Object(W.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return e.next=4,e.sent.json();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Q=function(e){return Object(j.jsx)("img",{src:"./loading.gif",style:{position:"absolute",left:e.left-e.size/2,top:e.top-e.size/2,height:e.size,opacity:.5,display:e.loading?"inline":"none"},alt:"source: https://tenor.com/view/loading-buffering-spinning-waiting-gif-17313179"})},$="https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}".concat(devicePixelRatio>1?"@2x":"",".png"),ee="https://api-dev.seattlecommunitynetwork.org/api/",te={dbm:"dB",ping:"ms",download_speed:"Mbps",upload_speed:"Mbps"},ne={dbm:1,ping:1,download_speed:1e-6,upload_speed:1e-6},ae={dbm:"Signal Strength",ping:"Ping",download_speed:"Download Speed",upload_speed:"Upload Speed"},ie=function(e){var t=e.mapType,n=e.selectedSites,i=e.setLoading,r=e.width,o=e.height,c=e.loading,l=Object(a.useState)(),d=Object(s.a)(l,2),u=d[0],p=d[1],f=Object(a.useState)(),b=Object(s.a)(f,2),h=b[0],m=b[1],g=Object(a.useState)(),v=Object(s.a)(g,2),y=v[0],x=v[1],O=Object(a.useState)(new Map),S=Object(s.a)(O,2),w=S[0],M=S[1],k=Object(a.useState)(),A=Object(s.a)(k,2),T=A[0],L=A[1];return Object(a.useEffect)((function(){Object(W.a)(D.a.mark((function e(){var t,n,a,s,c,l;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(ee+"dataRange");case 2:return t=e.sent,e.next=5,Z(ee+"sites");case 5:return n=e.sent,e.next=8,Z(ee+"sitesSummary");case 8:if(a=e.sent,s=z.map("map-id").setView(t.center,10),c=H(Object(N.a)(Object(N.a)({},t),{},{map:s,width:r,height:o})),l=new Map,G(n)){e.next=14;break}throw new Error("data has incorrect type");case 14:n.forEach((function(e){return l.set(e.name,q(e,a[e.name]).addTo(s))})),z.tileLayer($,{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',maxZoom:15,minZoom:10,opacity:.5}).addTo(s),M(l),x(c),m(s),L(z.layerGroup().addTo(s)),i(!1);case 21:case"end":return e.stop()}}),e)})))()}),[i,r,o]),Object(a.useEffect)((function(){h&&w&&w.forEach((function(e,t){n.some((function(e){return e.label===t}))?e.setOpacity(1):e.setOpacity(.5)}))}),[n,h,w]),Object(a.useEffect)((function(){h&&y&&T&&(i(!0),Object(W.a)(D.a.mark((function e(){var a,r,o,s,c;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(ee+"data?"+new URLSearchParams([["width",y.width+""],["height",y.height+""],["left",y.left+""],["top",y.top+""],["binSizeShift","1"],["zoom","10"],["selectedSites",n.map((function(e){return e.label})).join(",")],["mapType",t]]));case 2:o=e.sent,s=[null!==(a=R.h(o,(function(e){return e*ne[t]})))&&void 0!==a?a:1,null!==(r=R.i(o,(function(e){return e*ne[t]})))&&void 0!==r?r:0],c=R.n(s,R.f),p(s),T.clearLayers(),o.forEach((function(e,n){if(e){var a=(n/y.height<<1)+y.left,i=(n%y.height<<1)+y.top,r=h.unproject([a,i],10),o=h.unproject([a+2,i+2],10);z.rectangle(z.latLngBounds(r,o),{fillColor:c(e*ne[t]),fillOpacity:.75,stroke:!1}).addTo(T)}})),i(!1);case 9:case"end":return e.stop()}}),e)})))())}),[n,t,i,h,T,y]),Object(j.jsxs)("div",{style:{position:"relative"},children:[Object(j.jsx)("div",{id:"map-id",style:{height:o,width:r,position:"absolute"}}),Object(j.jsx)("div",{style:{position:"absolute",left:r-25},children:Object(j.jsx)(Y,{colorDomain:u,title:"".concat(ae[t]," (").concat(te[t],")"),width:25})}),Object(j.jsx)(Q,{left:r/2,top:o/2,size:70,loading:c})]})},re=R.m().domain(C.map((function(e){return e.name}))).range(R.p),oe=50,se=20,ce=0,le=20,de={dbm:"Signal Strength (dB)",ping:"Ping (ms)",upload_speed:"Upload Speed (Mbps)",download_speed:"Download Speed (Mbps)"},ue=function(e){var t=e.mapType,n=e.offset,i=e.width,r=e.height,o=e.selectedSites,c=e.setLoading,l=e.loading,d=Object(a.useState)(),u=Object(s.a)(d,2),p=u[0],f=u[1],b=Object(a.useState)(),h=Object(s.a)(b,2),m=h[0],g=h[1],v=Object(a.useState)(),y=Object(s.a)(v,2),x=y[0],O=y[1],S=Object(a.useState)(),w=Object(s.a)(S,2),M=w[0],k=w[1];return Object(a.useEffect)((function(){var e=R.q("#line-chart").append("g").attr("transform","translate(".concat(oe,", ").concat(le,")"));f(e.append("g")),g(e.append("g")),O(e.append("g")),k(e.append("g").attr("transform","translate(0,10)").append("text")),e.append("g").attr("transform","translate(0,0)").append("text"),c(!1)}),[f,g,O,k,c]),Object(a.useEffect)((function(){p&&m&&x&&M&&Object(W.a)(D.a.mark((function e(){var n,a,s,l,d,u,f,b,h,j,g,v,y;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),a=o.map((function(e){return e.label})),e.next=4,Z(ee+"lineSummary?"+new URLSearchParams([["mapType",t],["selectedSites",a.join(",")]]));case 4:s=e.sent.map((function(e){return{site:e.site,values:e.values.map((function(e){return{date:new Date(e.date),value:e.value}}))}})),l=i-oe-ce,d=r-le-se,u=s.map((function(e){return e.values})).flat(),f=R.o().domain(R.c(u,(function(e){return new Date(e.date)})).map((function(e){return null!==e&&void 0!==e?e:new Date(0)}))).range([0,l]),b=R.l().domain([0,(null!==(n=R.h(u,(function(e){return e.value})))&&void 0!==n?n:1)*ne[t]]).range([d,0]),h=R.a(f),j=R.b(b),g=R.g().x((function(e){return f(e.date)})).y((function(e){return b(e.value*ne[t])})),v=R.q("#line-chart"),y=R.q("#line-tooltip").style("position","absolute").style("background-color","white").style("border","solid").style("border-width","2px").style("border-radius","3px").style("padding","3px").style("font-size","small").style("opacity",1).style("display","none"),v.attr("width",i).attr("height",r),p.attr("transform","translate(0, ".concat(d,")")).style("user-select","none").transition().duration(1e3).call(h),m.style("user-select","none").transition().duration(1e3).call(j),M.attr("x",3).style("user-select","none").attr("font-size",12).attr("text-anchor","start").attr("font-weight","bold").text(de[t]),x.selectAll(".line").data(s,(function(e){return e.site})).join((function(e){return e.append("path").attr("d",(function(e){return g(e.values.map((function(e){return{date:e.date,value:0}})))})).attr("class","line").style("fill","none").style("stroke",(function(e){return re(e.site)+""})).style("stroke-width",2).style("stroke-linejoin","round").style("opacity",0).on("mouseover",(function(e,t){return y.style("display","inline").html(t.site)})).on("mousemove",(function(e,t){return y.html(t.site).style("left",e.pageX+10+"px").style("top",e.pageY+20+"px")})).on("mouseout",(function(){return y.style("display","none")}))}),(function(e){return e}),(function(e){return e.remove()})).transition().duration(1e3).style("opacity",1).attr("d",(function(e){return g(e.values)})),c(!1);case 21:case"end":return e.stop()}}),e)})))()}),[t,p,m,x,M,o,r,c,i]),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{style:{height:r,width:i,position:"relative",top:n},children:[Object(j.jsx)("svg",{id:"line-chart"}),Object(j.jsx)(Q,{left:i/2,top:r/2,size:70,loading:l})]}),Object(j.jsx)("div",{id:"line-tooltip",style:{position:"absolute",opacity:0}})]})};var pe=function(){var e=Object(a.useState)("ping"),t=Object(s.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)([]),o=Object(s.a)(r,2),d=o[0],u=o[1],p=Object(a.useState)(!0),f=Object(s.a)(p,2),b=f[0],h=f[1],m=Object(a.useState)(!0),v=Object(s.a)(m,2),y=v[0],x=v[1];return document.title="Performance Evaluation",Object(j.jsxs)("div",{className:"App",children:[Object(j.jsx)(T,{}),Object(j.jsx)(c.a,{children:Object(j.jsxs)(l.a,{container:!0,spacing:3,children:[Object(j.jsxs)(l.a,{item:!0,xs:3,children:[Object(j.jsx)(E,{selectedSites:d,setSelectedSites:u,loading:y||b}),Object(j.jsx)(g,{mapType:n,setMapType:i,loading:y||b})]}),Object(j.jsxs)(l.a,{item:!0,xs:9,children:[Object(j.jsx)(ie,{mapType:n,selectedSites:d,setLoading:h,width:910,height:500,loading:b}),Object(j.jsx)(ue,{mapType:n,offset:500,width:910,height:200,selectedSites:d,setLoading:x,loading:y})]})]})})]})};o.a.render(Object(j.jsx)(i.a.StrictMode,{children:Object(j.jsx)(pe,{})}),document.getElementById("root"))},48:function(e){e.exports=JSON.parse('[{"name":"David-TCN","latitude":47.23911,"longitude":-122.44989,"status":"active","address":"2309 S L St, Tacoma, WA 98405"},{"name":"SURGEtacoma","latitude":47.23854,"longitude":-122.44094,"status":"confirmed","address":"2367 Tacoma Ave S, Tacoma, WA 98402"},{"name":"Filipino Community Center","latitude":47.5501,"longitude":-122.2872,"status":"confirmed","address":"5740 Martin Luther King Jr Way S, Seattle, WA 98118"},{"name":"Oareao OCC Masjid","latitude":47.52391,"longitude":-122.27636,"status":"in-conversation","address":"8812 Renton Ave S, Seattle, WA 98118"},{"name":"ALTSpace","latitude":47.60816,"longitude":-122.30192,"status":"in-conversation","address":"2318 E Cherry St, Seattle, WA 98122"},{"name":"Franklin High School","latitude":47.576,"longitude":-122.29307,"status":"in-conversation","address":"3013 S Mt Baker Blvd, Seattle, WA 98144"},{"name":"Garfield High School","latitude":47.60533,"longitude":-122.3018,"status":"in-conversation","address":"400 23rd Ave, Seattle, WA 98122"},{"name":"Skyway Library","latitude":47.49049,"longitude":-122.23853,"status":"in-conversation","address":"12601 76th Ave S, Seattle, WA 98178"},{"name":"University Heights Center","latitude":47.66613,"longitude":-122.31374,"status":"in-conversation","address":"5031 University Way NE, Seattle, WA 98105"},{"name":"Hillside Church Kent","latitude":47.38639,"longitude":-122.22205,"status":"in-conversation","address":"930 E James St, Kent, WA 98031"}]')}},[[248,1,2]]]);
//# sourceMappingURL=main.6207a7f4.chunk.js.map