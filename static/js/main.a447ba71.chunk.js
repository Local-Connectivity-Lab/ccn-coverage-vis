(this["webpackJsonpcnn-coverage-vis"]=this["webpackJsonpcnn-coverage-vis"]||[]).push([[0],{102:function(e,t,n){},243:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(21),i=n.n(o),s=(n(102),n(6)),c=n(268),l=n(275),d=n(276),u=n(245),p=n(278),h=n(270),f=n(277),j=(n(56),n(2)),b={ping:1,upload_speed:1,download_speed:1};function m(e){return Object(j.jsx)("div",{className:"App",children:Object(j.jsx)(c.a,{children:Object(j.jsxs)(f.a,{component:"fieldset",disabled:e.loading,children:[Object(j.jsx)(u.a,{variant:"overline",children:"Map Type"}),Object(j.jsxs)(p.a,{row:!0,"aria-label":"gender",name:"gender1",value:e.mapType,onChange:function(t){var n=t.target.value;if(!(n in b))throw new Error("Invalid map type selection: "+n);e.setMapType(n)},children:[Object(j.jsx)(h.a,{value:"upload_speed",control:Object(j.jsx)(d.a,{}),label:"Upload Speed"}),Object(j.jsx)(h.a,{value:"download_speed",control:Object(j.jsx)(d.a,{}),label:"Download Speed"}),Object(j.jsx)(h.a,{value:"ping",control:Object(j.jsx)(d.a,{}),label:"Ping"})]})]})})})}var v=n(272),g=n(279),y=n(280),x=n(273),O=n(274),w=n(271),S=n(104),k=n.n(S),M=Object(v.a)((function(e){return Object(g.a)({root:{flexGrow:1,marginBottom:"20px"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}})}));function A(){var e=M();return Object(j.jsx)("div",{className:e.root,children:Object(j.jsx)(y.a,{position:"static",children:Object(j.jsxs)(x.a,{children:[Object(j.jsx)(w.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",children:Object(j.jsx)(k.a,{})}),Object(j.jsx)(u.a,{variant:"h6",className:e.title,children:"CCN - Performance Evaluation"}),Object(j.jsx)(O.a,{color:"inherit",children:"About"})]})})})}var E=n(105),L=n(45),T=L.map((function(e){var t=e.name;return{label:t,value:t}})),C=function(e){return Object(j.jsxs)("div",{children:[Object(j.jsx)(u.a,{variant:"overline",children:"Select Sites"}),Object(j.jsx)(E.a,{options:T,value:e.selectedSites,onChange:e.setSelectedSites,labelledBy:"Select",disabled:e.loading})]})},_=n(10),B=n.n(_),D=n(28),N=n(16),W=n(14),R=n(8);function G(e){return Math.round(100*e)/100}var P=new Map([["active","green"],["confirmed","yellow"],["in-conversation","red"]]);function U(e){return e.every(z)}function z(e){return"string"===typeof(null===e||void 0===e?void 0:e.name)||"number"===typeof(null===e||void 0===e?void 0:e.latitude)||"number"===typeof(null===e||void 0===e?void 0:e.longitude)||"string"===typeof(null===e||void 0===e?void 0:e.address)||(null===e||void 0===e?void 0:e.status)in P}function J(e,t){return W.marker([e.latitude,e.longitude]).bindPopup("".concat(e.name,' <span style="background-color: ').concat(P.get(e.status),'">[').concat(e.status,"]</span><br />").concat(e.address,"<br/>ping: ").concat(G((null===t||void 0===t?void 0:t.ping)*ee.ping)," ").concat($.ping,"<br/>upload speed: ").concat(G((null===t||void 0===t?void 0:t.upload_speed)*ee.upload_speed)," ").concat($.upload_speed,"<br/>download speed: ").concat(G((null===t||void 0===t?void 0:t.download_speed)*ee.download_speed)," ").concat($.download_speed))}function q(e){var t=e.map,n=e.center,a=e.minLat,r=e.minLon,o=e.maxLat,i=e.maxLon,s=e.width,c=e.height,l=t.project(n),d=l.x,u=l.y,p=t.project([a,r]),h=[Math.floor(Math.min(d-s/2,p.x-s/10)),Math.ceil(Math.max(u+c/2,p.y+c/10))],f=t.project([o,i]),j=[Math.ceil(Math.max(d+s/2,f.x+s/10)),Math.floor(Math.min(u-c/2,f.y-c/10))],b=t.unproject(h),m=t.unproject(j),v=W.latLngBounds(b,m);return t.setMaxBounds(v).on("drag",(function(){return t.panInsideBounds(v,{animate:!1})})),{width:j[0]-h[0],height:h[1]-j[1],left:h[0],top:j[1]}}var F=n(106),H=150,I=40,K=H/64;var V=function(e){var t=e.colorDomain,n=e.title,r=e.width,o=Object(a.useRef)(null);if(t&&o.current){var i=R.n(t,R.f),s=R.d(".2f"),c=R.q(o.current).attr("width",r).attr("height",H).attr("viewBox",[0,0,r,H].join(" ")).style("overflow","visible").style("display","block");c.selectAll("*").remove();var l=Object.assign(i.copy().interpolator(R.e(I,H-0)),{range:function(){return[H-0,I]}});c.append("image").attr("x",0).attr("y",I).attr("width",r-0-15).attr("height",H-I-0).attr("preserveAspectRatio","none").attr("xlink:href",function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,n=Object(F.createCanvas)(1,t),a=n.getContext("2d"),r=0;r<t;++r)a.fillStyle=e(r/(t-1)),a.fillRect(0,r,1,1);return n}(i.interpolator(),H-I-0).toDataURL());var d=Math.round(K+1),u=R.k(d).map((function(e){var t;return null!==(t=R.j(i.domain(),e/(d-1)))&&void 0!==t?t:NaN}));c.append("g").attr("transform","translate(".concat(0,",",0,")")).call(R.b(l).ticks(K,"string"===typeof s?s:void 0).tickSize(6).tickValues(u)).call((function(e){return e.selectAll(".tick line").attr("x1",r-15-0)})).call((function(e){return e.select(".domain").remove()})).call((function(e){return e.append("text").attr("y",28).attr("x",r-15-0-2).attr("fill","currentColor").attr("text-anchor","begin").attr("font-weight","bold").attr("class","title").text(n)}))}return Object(j.jsx)("svg",{id:"map-legend",ref:o,className:"leaflet-control"})};function Y(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(N.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return e.next=4,e.sent.json();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var X="https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}".concat(devicePixelRatio>1?"@2x":"",".png"),Q="http://localhost:7593/",$={ping:"ms",download_speed:"Gbps",upload_speed:"Gbps"},ee={ping:1,download_speed:1e-6,upload_speed:1e-6},te={ping:"Ping",download_speed:"Download Speed",upload_speed:"Upload Speed"},ne=function(e){var t=e.mapType,n=e.selectedSites,r=e.setLoading,o=e.width,i=e.height,c=Object(a.useState)(),l=Object(s.a)(c,2),d=l[0],u=l[1],p=Object(a.useState)(),h=Object(s.a)(p,2),f=h[0],b=h[1],m=Object(a.useState)(),v=Object(s.a)(m,2),g=v[0],y=v[1],x=Object(a.useState)(new Map),O=Object(s.a)(x,2),w=O[0],S=O[1],k=Object(a.useState)(),M=Object(s.a)(k,2),A=M[0],E=M[1];return Object(a.useEffect)((function(){Object(N.a)(B.a.mark((function e(){var t,n,a,s,c,l;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(Q+"dataRange");case 2:return t=e.sent,e.next=5,Y(Q+"sites");case 5:return n=e.sent,e.next=8,Y(Q+"sitesSummary");case 8:if(a=e.sent,s=W.map("map-id").setView(t.center,10),c=q(Object(D.a)(Object(D.a)({},t),{},{map:s,width:o,height:i})),l=new Map,U(n)){e.next=14;break}throw new Error("data has incorrect type");case 14:n.forEach((function(e){return l.set(e.name,J(e,a[e.name]))})),W.tileLayer(X,{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',maxZoom:15,minZoom:10,opacity:.5}).addTo(s),S(l),y(c),b(s),E(W.layerGroup().addTo(s)),r(!1);case 21:case"end":return e.stop()}}),e)})))()}),[r,o,i]),Object(a.useEffect)((function(){f&&w&&w.forEach((function(e,t){n.some((function(e){return e.label===t}))?e.addTo(f):e.removeFrom(f)}))}),[n,f,w]),Object(a.useEffect)((function(){f&&g&&A&&(r(!0),Object(N.a)(B.a.mark((function e(){var a,o,i,s,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(Q+"data?"+new URLSearchParams([["width",g.width+""],["height",g.height+""],["left",g.left+""],["top",g.top+""],["binSizeShift","1"],["zoom","10"],["selectedSites",n.map((function(e){return e.label})).join(",")],["mapType",t]]));case 2:i=e.sent,s=[null!==(a=R.h(i,(function(e){return e*ee[t]})))&&void 0!==a?a:1,null!==(o=R.i(i,(function(e){return e*ee[t]})))&&void 0!==o?o:0],c=R.n(s,R.f),u(s),A.clearLayers(),i.forEach((function(e,n){if(e){var a=(n/g.height<<1)+g.left,r=(n%g.height<<1)+g.top,o=f.unproject([a,r],10),i=f.unproject([a+2,r+2],10);W.rectangle(W.latLngBounds(o,i),{fillColor:c(e*ee[t]),fillOpacity:.75,stroke:!1}).addTo(A)}})),r(!1);case 9:case"end":return e.stop()}}),e)})))())}),[n,t,r,f,A,g]),Object(j.jsxs)("div",{style:{position:"relative"},children:[Object(j.jsx)("div",{id:"map-id",style:{height:i,width:o,position:"absolute"}}),Object(j.jsx)("div",{style:{position:"absolute",left:o-25},children:Object(j.jsx)(V,{colorDomain:d,title:"".concat(te[t]," (").concat($[t],")"),width:25})})]})},ae=n(29),re=R.m().domain(L.map((function(e){return e.name}))).range(R.p),oe=50,ie=20,se=0,ce=20,le={ping:"Ping (ms)",upload_speed:"Upload Speed (Gbps)",download_speed:"Download Speed (Gbps)"},de=function(e){var t=[],n=new Set;return e.forEach((function(e){return Object.keys(e.values).forEach((function(e){return n.add(e)}))})),n.forEach((function(n){for(var a={key:n,color:re(n)+"",data:[]},r=0,o=e.length;r<o;r++){var i=e[r];i.values[n]&&a.data.push({date:new Date(i.date),value:i.values[n]})}t.push(a)})),t},ue=function(e){var t=e.mapType,n=e.offset,r=e.width,o=e.height,i=e.selectedSites,c=e.setLoading,l=Object(a.useState)(),d=Object(s.a)(l,2),u=d[0],p=d[1],h=Object(a.useState)(),f=Object(s.a)(h,2),b=f[0],m=f[1],v=Object(a.useState)(),g=Object(s.a)(v,2),y=g[0],x=g[1],O=Object(a.useState)(),w=Object(s.a)(O,2),S=w[0],k=w[1];return Object(a.useEffect)((function(){var e=R.q("#line-chart").append("g").attr("transform","translate(".concat(oe,", ").concat(ce,")"));p(e.append("g")),m(e.append("g")),x(e.append("g")),k(e.append("g").attr("transform","translate(0,10)").append("text")),e.append("g").attr("transform","translate(0,0)").append("text"),c(!1)}),[p,m,x,k,c]),Object(a.useEffect)((function(){u&&b&&y&&S&&Object(N.a)(B.a.mark((function e(){var n,a,s,l,d,p,h,f,j,m,v,g,x;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),a=i.map((function(e){return e.label})),e.next=4,Y(Q+"lineSummary?"+new URLSearchParams([["mapType",t],["selectedSites",a.join(",")]]));case 4:s=e.sent,l=r-oe-se,d=o-ce-ie,p=R.o().domain(R.c(s,(function(e){return new Date(e.date)})).map((function(e){return null!==e&&void 0!==e?e:new Date(0)}))).range([0,l]),h=R.l().domain([0,(null!==(n=R.h(s,(function(e){return Math.max.apply(Math,Object(ae.a)(Object.values(e.values)))})))&&void 0!==n?n:1)*ee[t]]).range([d,0]),f=R.a(p),j=R.b(h),m=R.g().x((function(e){return p(e.date)})).y((function(e){return h(e.value*ee[t])})),v=de(s),g=R.q("#line-chart"),x=R.q("#line-tooltip").style("position","absolute").style("background-color","white").style("border","solid").style("border-width","2px").style("border-radius","3px").style("padding","3px").style("font-size","small").style("opacity",1).style("display","none"),g.attr("width",r).attr("height",o),u.attr("transform","translate(0, ".concat(d,")")).transition().duration(1e3).call(f),b.transition().duration(1e3).call(j),S.attr("x",3).attr("font-size",12).attr("text-anchor","start").attr("font-weight","bold").text(le[t]),y.selectAll(".line").data(v,(function(e){return e.key})).join((function(e){return e.append("path").attr("d",(function(e){return m(e.data)})).attr("class","line").style("fill","none").style("stroke",(function(e){return e.color})).style("stroke-width",2).style("stroke-linejoin","round").style("opacity",0).on("mouseover",(function(e,t){x.style("display","inline").html(t.key),console.log("over")})).on("mousemove",(function(e,t){x.html(t.key).style("left",e.pageX+10+"px").style("top",e.pageY+20+"px"),console.log("move")})).on("mouseout",(function(e,t){x.style("display","none")}))}),(function(e){return e}),(function(e){return e.remove()})).transition().duration(1e3).style("opacity",1).attr("d",(function(e){return m(e.data)})),c(!1);case 21:case"end":return e.stop()}}),e)})))()}),[t,u,b,y,S,i,o,c,r]),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{style:{height:o,width:r,position:"relative",top:n},children:Object(j.jsx)("svg",{id:"line-chart"})}),Object(j.jsx)("div",{id:"line-tooltip",style:{position:"absolute",opacity:0}})]})};var pe=function(){var e=Object(a.useState)("ping"),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)([]),i=Object(s.a)(o,2),d=i[0],u=i[1],p=Object(a.useState)(!0),h=Object(s.a)(p,2),f=h[0],b=h[1],v=Object(a.useState)(!0),g=Object(s.a)(v,2),y=g[0],x=g[1];return document.title="Performance Evaluation",Object(j.jsxs)("div",{className:"App",children:[Object(j.jsx)(A,{}),Object(j.jsx)(c.a,{children:Object(j.jsxs)(l.a,{container:!0,spacing:3,children:[Object(j.jsx)(l.a,{item:!0,xs:3,children:Object(j.jsx)(C,{selectedSites:d,setSelectedSites:u,loading:y||f})}),Object(j.jsxs)(l.a,{item:!0,xs:9,children:[Object(j.jsx)(m,{mapType:n,setMapType:r,loading:y||f}),Object(j.jsx)(ne,{mapType:n,selectedSites:d,setLoading:b,width:910,height:500}),Object(j.jsx)(ue,{mapType:n,offset:500,width:910,height:200,selectedSites:d,setLoading:x})]})]})})]})};i.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(pe,{})}),document.getElementById("root"))},45:function(e){e.exports=JSON.parse('[{"name":"David-TCN","latitude":47.23911,"longitude":-122.44989,"status":"active","address":"2309 S L St, Tacoma, WA 98405"},{"name":"SURGEtacoma","latitude":47.23854,"longitude":-122.44094,"status":"confirmed","address":"2367 Tacoma Ave S, Tacoma, WA 98402"},{"name":"Filipino Community Center","latitude":47.5501,"longitude":-122.2872,"status":"confirmed","address":"5740 Martin Luther King Jr Way S, Seattle, WA 98118"},{"name":"Oareao OCC Masjid","latitude":47.52391,"longitude":-122.27636,"status":"in-conversation","address":"8812 Renton Ave S, Seattle, WA 98118"},{"name":"ALTSpace","latitude":47.60816,"longitude":-122.30192,"status":"in-conversation","address":"2318 E Cherry St, Seattle, WA 98122"},{"name":"Franklin High School","latitude":47.576,"longitude":-122.29307,"status":"in-conversation","address":"3013 S Mt Baker Blvd, Seattle, WA 98144"},{"name":"Garfield High School","latitude":47.60533,"longitude":-122.3018,"status":"in-conversation","address":"400 23rd Ave, Seattle, WA 98122"},{"name":"Skyway Library","latitude":47.49049,"longitude":-122.23853,"status":"in-conversation","address":"12601 76th Ave S, Seattle, WA 98178"},{"name":"University Heights Center","latitude":47.66613,"longitude":-122.31374,"status":"in-conversation","address":"5031 University Way NE, Seattle, WA 98105"},{"name":"Hillside Church Kent","latitude":47.38639,"longitude":-122.22205,"status":"in-conversation","address":"930 E James St, Kent, WA 98031"}]')}},[[243,1,2]]]);
//# sourceMappingURL=main.a447ba71.chunk.js.map