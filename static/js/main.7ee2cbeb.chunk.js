(this["webpackJsonpcnn-coverage-vis"]=this["webpackJsonpcnn-coverage-vis"]||[]).push([[0],{104:function(e,t,n){},248:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(23),r=n.n(o),s=(n(104),n(5)),c=n(277),l=n(278),d=n(280),u=n(251),p=n(282),f=n(279),b=n(272),m=n(281),h=(n(59),n(2)),j={dbm:1,ping:1,upload_speed:1,download_speed:1};function g(e){return Object(h.jsx)(f.a,{className:"App",children:Object(h.jsxs)(m.a,{component:"fieldset",disabled:e.loading,children:[Object(h.jsx)(u.a,{variant:"overline",children:"Map Type"}),Object(h.jsxs)(p.a,{"aria-label":"Map Type",name:"maptype",value:e.mapType,onChange:function(t){var n=t.target.value;if(!(n in j))throw new Error("Invalid map type selection: "+n);e.setMapType(n)},children:[Object(h.jsx)(b.a,{value:"dbm",control:Object(h.jsx)(d.a,{}),label:"Signal Strength"}),Object(h.jsx)(b.a,{value:"upload_speed",control:Object(h.jsx)(d.a,{}),label:"Upload Speed"}),Object(h.jsx)(b.a,{value:"download_speed",control:Object(h.jsx)(d.a,{}),label:"Download Speed"}),Object(h.jsx)(b.a,{value:"ping",control:Object(h.jsx)(d.a,{}),label:"Ping"})]})]})})}var v=n(274),y=n(283),x=n(284),O=n(275),S=n(276),w=n(273),M=n(105),k=n.n(M),A=Object(v.a)((function(e){return Object(y.a)({root:{flexGrow:1,marginBottom:"20px"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}})}));function T(){var e=A();return Object(h.jsx)("div",{className:e.root,children:Object(h.jsx)(x.a,{position:"static",children:Object(h.jsxs)(O.a,{children:[Object(h.jsx)(w.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",children:Object(h.jsx)(k.a,{})}),Object(h.jsx)(u.a,{variant:"h6",className:e.title,children:"CCN - Performance Evaluation"}),Object(h.jsx)(S.a,{color:"inherit",children:"About"})]})})})}var L=n(107),C=n(48),_=C.map((function(e){var t=e.name;return{label:t,value:t}})),E=function(e){return Object(h.jsxs)(f.a,{mb:2,children:[Object(h.jsx)(u.a,{variant:"overline",children:"Select Sites"}),Object(h.jsx)(L.a,{options:_,value:e.selectedSites,onChange:e.setSelectedSites,labelledBy:"Select",disabled:e.loading})]})},B=n(10),D=n.n(B),N=n(62),W=n(20),z=n(14),R=n(7);function U(e){return Math.round(100*e)/100}var P=new Map([["active","green"],["confirmed","yellow"],["in-conversation","red"]]);function G(e){return e.every(J)}function J(e){return"string"===typeof(null===e||void 0===e?void 0:e.name)||"number"===typeof(null===e||void 0===e?void 0:e.latitude)||"number"===typeof(null===e||void 0===e?void 0:e.longitude)||"string"===typeof(null===e||void 0===e?void 0:e.address)||(null===e||void 0===e?void 0:e.status)in P}function q(e,t){return z.marker([e.latitude,e.longitude]).bindTooltip("".concat(e.name,' <span style="background-color: ').concat(P.get(e.status),'">[').concat(e.status,"]</span><br />").concat(e.address,"<br/>\n    signal strength: ").concat(U((null===t||void 0===t?void 0:t.dbm)*ne.dbm)," ").concat(te.dbm,"<br/>\n    ping: ").concat(U((null===t||void 0===t?void 0:t.ping)*ne.ping)," ").concat(te.ping,"<br/>\n    upload speed: ").concat(U((null===t||void 0===t?void 0:t.upload_speed)*ne.upload_speed)," ").concat(te.upload_speed,"<br/>\n    download speed: ").concat(U((null===t||void 0===t?void 0:t.download_speed)*ne.download_speed)," ").concat(te.download_speed))}function H(e){var t=e.map,n=e.center,a=e.minLat,i=e.minLon,o=e.maxLat,r=e.maxLon,s=e.width,c=e.height,l=t.project(n),d=l.x,u=l.y,p=t.project([a,i]),f=[Math.floor(Math.min(d-s/2,p.x-s/10)),Math.ceil(Math.max(u+c/2,p.y+c/10))],b=t.project([o,r]),m=[Math.ceil(Math.max(d+s/2,b.x+s/10)),Math.floor(Math.min(u-c/2,b.y-c/10))],h=t.unproject(f),j=t.unproject(m),g=z.latLngBounds(h,j);return t.setMaxBounds(g).on("drag",(function(){return t.panInsideBounds(g,{animate:!1})})),{width:m[0]-f[0],height:f[1]-m[1],left:f[0],top:m[1]}}var F=n(106),I=150,K=40,V=I/64;var Y=function(e){var t=e.colorDomain,n=e.title,i=e.width,o=Object(a.useRef)(null);if(t&&o.current){var r=R.n(t,R.f),s=R.d(".2f"),c=R.q(o.current).attr("width",i).attr("height",I).attr("viewBox",[0,0,i,I].join(" ")).style("overflow","visible").style("display","block");c.selectAll("*").remove();var l=Object.assign(r.copy().interpolator(R.e(K,I-0)),{range:function(){return[I-0,K]}});c.append("image").attr("x",0).attr("y",K).attr("width",i-0-15).attr("height",I-K-0).attr("preserveAspectRatio","none").attr("xlink:href",function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,n=Object(F.createCanvas)(1,t),a=n.getContext("2d"),i=0;i<t;++i)a.fillStyle=e(i/(t-1)),a.fillRect(0,i,1,1);return n}(r.interpolator(),I-K-0).toDataURL());var d=Math.round(V+1),u=R.k(d).map((function(e){var t;return null!==(t=R.j(r.domain(),e/(d-1)))&&void 0!==t?t:NaN}));c.append("g").attr("transform","translate(".concat(0,",",0,")")).call(R.b(l).ticks(V,"string"===typeof s?s:void 0).tickSize(6).tickValues(u)).call((function(e){return e.selectAll(".tick line").attr("x1",i-15-0)})).call((function(e){return e.select(".domain").remove()})).call((function(e){return e.append("text").attr("y",28).attr("x",i-15-0-2).attr("fill","currentColor").attr("text-anchor","begin").attr("font-weight","bold").attr("class","title").text(n)}))}return Object(h.jsx)("svg",{id:"map-legend",ref:o,className:"leaflet-control"})};function Z(e){return X.apply(this,arguments)}function X(){return(X=Object(W.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return e.next=4,e.sent.json();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Q=function(e){return Object(h.jsx)("img",{src:"./loading.gif",style:{position:"absolute",left:e.left-e.size/2,top:e.top-e.size/2,height:e.size,opacity:.5,display:e.loading?"inline":"none"},alt:"source: https://tenor.com/view/loading-buffering-spinning-waiting-gif-17313179"})},$="https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}".concat(devicePixelRatio>1?"@2x":"",".png"),ee="https://api-dev.seattlecommunitynetwork.org/api/",te={dbm:"dBm",ping:"ms",download_speed:"Mbps",upload_speed:"Mbps"},ne={dbm:1,ping:1,download_speed:1,upload_speed:1},ae={dbm:"Signal Strength",ping:"Ping",download_speed:"Download Speed",upload_speed:"Upload Speed"},ie=function(e){var t=e.mapType,n=e.selectedSites,i=e.setLoading,o=e.width,r=e.height,c=e.loading,l=Object(a.useState)(),d=Object(s.a)(l,2),u=d[0],p=d[1],f=Object(a.useState)(),b=Object(s.a)(f,2),m=b[0],j=b[1],g=Object(a.useState)(),v=Object(s.a)(g,2),y=v[0],x=v[1],O=Object(a.useState)(new Map),S=Object(s.a)(O,2),w=S[0],M=S[1],k=Object(a.useState)(),A=Object(s.a)(k,2),T=A[0],L=A[1];return Object(a.useEffect)((function(){Object(W.a)(D.a.mark((function e(){var t,n,a,s,c,l;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(ee+"dataRange");case 2:return t=e.sent,e.next=5,Z(ee+"sites");case 5:return n=e.sent,e.next=8,Z(ee+"sitesSummary");case 8:if(a=e.sent,s=z.map("map-id").setView(t.center,10),c=H(Object(N.a)(Object(N.a)({},t),{},{map:s,width:o,height:r})),l=new Map,G(n)){e.next=14;break}throw new Error("data has incorrect type");case 14:n.forEach((function(e){return l.set(e.name,q(e,a[e.name]).addTo(s))})),z.tileLayer($,{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',maxZoom:15,minZoom:10,opacity:.5}).addTo(s),M(l),x(c),j(s),L(z.layerGroup().addTo(s)),i(!1);case 21:case"end":return e.stop()}}),e)})))()}),[i,o,r]),Object(a.useEffect)((function(){m&&w&&w.forEach((function(e,t){n.some((function(e){return e.label===t}))?e.setOpacity(1):e.setOpacity(.5)}))}),[n,m,w]),Object(a.useEffect)((function(){m&&y&&T&&(i(!0),Object(W.a)(D.a.mark((function e(){var a,o,r,s,c;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(ee+"data?"+new URLSearchParams([["width",y.width+""],["height",y.height+""],["left",y.left+""],["top",y.top+""],["binSizeShift","0"],["zoom","10"],["selectedSites",n.map((function(e){return e.label})).join(",")],["mapType",t]]));case 2:r=e.sent,s=[null!==(a=R.h(r,(function(e){return e*ne[t]})))&&void 0!==a?a:1,null!==(o=R.i(r,(function(e){return e*ne[t]})))&&void 0!==o?o:0],c=R.n(s,R.f),p(s),T.clearLayers(),r.forEach((function(e,n){if(e){var a=(n/y.height<<0)+y.left,i=(n%y.height<<0)+y.top,o=m.unproject([a,i],10),r=m.unproject([a+1,i+1],10);z.rectangle(z.latLngBounds(o,r),{fillColor:c(e*ne[t]),fillOpacity:.75,stroke:!1}).addTo(T)}})),i(!1);case 9:case"end":return e.stop()}}),e)})))())}),[n,t,i,m,T,y]),Object(h.jsxs)("div",{style:{position:"relative"},children:[Object(h.jsx)("div",{id:"map-id",style:{height:r,width:o,position:"absolute"}}),Object(h.jsx)("div",{style:{position:"absolute",left:o-25},children:Object(h.jsx)(Y,{colorDomain:u,title:"".concat(ae[t]," (").concat(te[t],")"),width:25})}),Object(h.jsx)(Q,{left:o/2,top:r/2,size:70,loading:c})]})},oe=R.m().domain(C.map((function(e){return e.name}))).range(R.p),re=50,se=20,ce=0,le=20,de={dbm:"Signal Strength (dB)",ping:"Ping (ms)",upload_speed:"Upload Speed (Mbps)",download_speed:"Download Speed (Mbps)"},ue=function(e){var t=e.mapType,n=e.offset,i=e.width,o=e.height,r=e.selectedSites,c=e.setLoading,l=e.loading,d=Object(a.useState)(),u=Object(s.a)(d,2),p=u[0],f=u[1],b=Object(a.useState)(),m=Object(s.a)(b,2),j=m[0],g=m[1],v=Object(a.useState)(),y=Object(s.a)(v,2),x=y[0],O=y[1],S=Object(a.useState)(),w=Object(s.a)(S,2),M=w[0],k=w[1];return Object(a.useEffect)((function(){var e=R.q("#line-chart").append("g").attr("transform","translate(".concat(re,", ").concat(le,")"));f(e.append("g")),g(e.append("g")),O(e.append("g")),k(e.append("g").attr("transform","translate(0,10)").append("text")),e.append("g").attr("transform","translate(0,0)").append("text"),c(!1)}),[f,g,O,k,c]),Object(a.useEffect)((function(){p&&j&&x&&M&&Object(W.a)(D.a.mark((function e(){var n,a,s,l,d,u,f,b,m,h,g,v,y,O,S;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),n=r.map((function(e){return e.label})),e.next=4,Z(ee+"lineSummary?"+new URLSearchParams([["mapType",t],["selectedSites",n.join(",")]]));case 4:a=e.sent.map((function(e){return{site:e.site,values:e.values.map((function(e){return{date:new Date(e.date),value:e.value}}))}})),s=i-re-ce,l=o-le-se,d=a.map((function(e){return e.values})).flat(),u=R.o().domain(R.c(d,(function(e){return new Date(e.date)})).map((function(e){return null!==e&&void 0!==e?e:new Date(0)}))).range([0,s]),f="dbm"===t?R.l().domain([(null!==(b=R.h(d,(function(e){return e.value})))&&void 0!==b?b:1)*ne[t],(null!==(m=R.i(d,(function(e){return e.value})))&&void 0!==m?m:1)*ne[t]]).range([0,l]):R.l().domain([0,(null!==(h=R.h(d,(function(e){return e.value})))&&void 0!==h?h:1)*ne[t]]).range([l,0]),g=R.a(u),v=R.b(f),y=R.g().x((function(e){return u(e.date)})).y((function(e){return f(e.value*ne[t])})),O=R.q("#line-chart"),S=R.q("#line-tooltip").style("position","absolute").style("background-color","white").style("border","solid").style("border-width","2px").style("border-radius","3px").style("padding","3px").style("font-size","small").style("opacity",1).style("display","none"),O.attr("width",i).attr("height",o),p.attr("transform","translate(0, ".concat(l,")")).style("user-select","none").transition().duration(1e3).call(g),j.style("user-select","none").transition().duration(1e3).call(v),M.attr("x",3).style("user-select","none").attr("font-size",12).attr("text-anchor","start").attr("font-weight","bold").text(de[t]),x.selectAll(".line").data(a,(function(e){return e.site})).join((function(e){return e.append("path").attr("d",(function(e){return y(e.values.map((function(e){return{date:e.date,value:0}})))})).attr("class","line").style("fill","none").style("stroke",(function(e){return oe(e.site)+""})).style("stroke-width",2).style("stroke-linejoin","round").style("opacity",0).on("mouseover",(function(e,t){return S.style("display","inline").html(t.site)})).on("mousemove",(function(e,t){return S.html(t.site).style("left",e.pageX+10+"px").style("top",e.pageY+20+"px")})).on("mouseout",(function(){return S.style("display","none")}))}),(function(e){return e}),(function(e){return e.remove()})).transition().duration(1e3).style("opacity",1).attr("d",(function(e){return y(e.values)})),c(!1);case 21:case"end":return e.stop()}}),e)})))()}),[t,p,j,x,M,r,o,c,i]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{style:{height:o,width:i,position:"relative",top:n},children:[Object(h.jsx)("svg",{id:"line-chart"}),Object(h.jsx)(Q,{left:i/2,top:o/2,size:70,loading:l})]}),Object(h.jsx)("div",{id:"line-tooltip",style:{position:"absolute",opacity:0}})]})};var pe=function(){var e=Object(a.useState)("ping"),t=Object(s.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)([]),r=Object(s.a)(o,2),d=r[0],u=r[1],p=Object(a.useState)(!0),f=Object(s.a)(p,2),b=f[0],m=f[1],j=Object(a.useState)(!0),v=Object(s.a)(j,2),y=v[0],x=v[1];return document.title="Performance Evaluation",Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(T,{}),Object(h.jsx)(c.a,{children:Object(h.jsxs)(l.a,{container:!0,spacing:3,children:[Object(h.jsxs)(l.a,{item:!0,xs:3,children:[Object(h.jsx)(E,{selectedSites:d,setSelectedSites:u,loading:y||b}),Object(h.jsx)(g,{mapType:n,setMapType:i,loading:y||b})]}),Object(h.jsxs)(l.a,{item:!0,xs:9,children:[Object(h.jsx)(ie,{mapType:n,selectedSites:d,setLoading:m,width:910,height:500,loading:b}),Object(h.jsx)(ue,{mapType:n,offset:500,width:910,height:200,selectedSites:d,setLoading:x,loading:y})]})]})})]})};r.a.render(Object(h.jsx)(i.a.StrictMode,{children:Object(h.jsx)(pe,{})}),document.getElementById("root"))},48:function(e){e.exports=JSON.parse('[{"name":"David-TCN","latitude":47.23911,"longitude":-122.44989,"status":"active","address":"2309 S L St, Tacoma, WA 98405"},{"name":"SURGEtacoma","latitude":47.23854,"longitude":-122.44094,"status":"confirmed","address":"2367 Tacoma Ave S, Tacoma, WA 98402"},{"name":"Filipino Community Center","latitude":47.5501,"longitude":-122.2872,"status":"confirmed","address":"5740 Martin Luther King Jr Way S, Seattle, WA 98118"},{"name":"Oareao OCC Masjid","latitude":47.52391,"longitude":-122.27636,"status":"in-conversation","address":"8812 Renton Ave S, Seattle, WA 98118"},{"name":"ALTSpace","latitude":47.60816,"longitude":-122.30192,"status":"in-conversation","address":"2318 E Cherry St, Seattle, WA 98122"},{"name":"Franklin High School","latitude":47.576,"longitude":-122.29307,"status":"in-conversation","address":"3013 S Mt Baker Blvd, Seattle, WA 98144"},{"name":"Garfield High School","latitude":47.60533,"longitude":-122.3018,"status":"in-conversation","address":"400 23rd Ave, Seattle, WA 98122"},{"name":"Skyway Library","latitude":47.49049,"longitude":-122.23853,"status":"in-conversation","address":"12601 76th Ave S, Seattle, WA 98178"},{"name":"University Heights Center","latitude":47.66613,"longitude":-122.31374,"status":"in-conversation","address":"5031 University Way NE, Seattle, WA 98105"},{"name":"Hillside Church Kent","latitude":47.38639,"longitude":-122.22205,"status":"in-conversation","address":"930 E James St, Kent, WA 98031"}]')}},[[248,1,2]]]);
//# sourceMappingURL=main.7ee2cbeb.chunk.js.map